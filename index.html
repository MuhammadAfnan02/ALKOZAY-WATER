<!DOCTYPE html>
<html lang="en">
<head>
<script src="database.js"></script>
    <script src="app.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0288d1">
    <title>Alkozay Factory Manager Pro v4.0</title>
    <style>
        :root {
            --primary: #0288d1;
            --primary-dark: #01579b;
            --secondary: #26c6da;
            --accent: #ffa726;
            --danger: #ef5350;
            --success: #66bb6a;
            --dark: #0f172a;
            --light: #f8fafc;
            --surface: #ffffff;
            --text-main: #334155;
            --text-light: #94a3b8;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --sidebar-width: 280px;
            --safe-area-top: env(safe-area-inset-top);
        }

        [data-theme="dark"] {
            --light: #0f172a;
            --surface: #1e293b;
            --text-main: #f1f5f9;
            --text-light: #cbd5e1;
            --dark: #020617;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.5);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; -webkit-tap-highlight-color: transparent; font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; }
        body { background-color: var(--light); color: var(--text-main); display: flex; height: 100vh; overflow: hidden; transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        
        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-thumb { background: #94a3b8; border-radius: 4px; }

        .sidebar {
            width: var(--sidebar-width);
            background: var(--dark);
            color: white;
            display: flex;
            flex-direction: column;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 1000;
            height: 100%;
            box-shadow: 4px 0 24px rgba(0,0,0,0.2);
        }
        
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            background: var(--light);
        }

        .brand { 
            padding: 30px 25px; 
            font-size: 1.5rem; 
            font-weight: 800; 
            border-bottom: 1px solid rgba(255,255,255,0.05); 
            letter-spacing: 1px; 
            color: var(--surface); 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            background: rgba(255,255,255,0.03);
            padding-top: calc(30px + var(--safe-area-top));
        }
        .brand span { color: var(--secondary); }
        .nav-links { list-style: none; padding: 20px 0; flex: 1; overflow-y: auto; }
        .nav-item { padding: 18px 25px; cursor: pointer; display: flex; align-items: center; gap: 15px; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); color: #94a3b8; border-left: 4px solid transparent; font-size: 1rem; font-weight: 500; }
        .nav-item:active { background: rgba(255,255,255,0.1); transform: scale(0.98); }
        .nav-item.active { background: linear-gradient(90deg, rgba(38, 198, 218, 0.15) 0%, transparent 100%); color: var(--secondary); border-left-color: var(--secondary); }
        
        header { background: var(--surface); height: 70px; padding: 0 20px; display: flex; align-items: center; justify-content: space-between; box-shadow: var(--shadow); z-index: 90; transition: all 0.3s; padding-top: var(--safe-area-top); }
        .toggle-btn { display: none; background: none; border: none; font-size: 1.6rem; cursor: pointer; color: var(--text-main); padding: 10px; transition: transform 0.2s; }
        .toggle-btn:active { transform: scale(0.9); }
        .header-title h2 { font-size: 1.3rem; font-weight: 700; color: var(--text-main); }
        .header-title p { font-size: 0.8rem; color: var(--text-light); margin-top: 2px; }
        
        .btn-primary { 
            background: var(--primary); 
            color: white; 
            border: none; 
            padding: 12px 24px; 
            border-radius: 12px; 
            cursor: pointer; 
            font-weight: 600; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            box-shadow: 0 4px 12px rgba(2, 136, 209, 0.3); 
            display: flex; align-items: center; gap: 8px;
        }
        .btn-primary:active { transform: scale(0.96); }

        .theme-switch { background: none; border: none; font-size: 1.5rem; cursor: pointer; padding: 10px; border-radius: 50%; transition: all 0.3s; margin-right: 10px; }
        .theme-switch:active { transform: scale(0.9); }

        .view { display: none; padding: 20px; overflow-y: auto; height: calc(100vh - 70px); -webkit-overflow-scrolling: touch; padding-bottom: 100px; opacity: 0; transform: translateY(10px); }
        .view.active { display: block; animation: slideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards; }
        
        @keyframes slideIn { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        @keyframes popIn { 
            from { opacity: 0; transform: scale(0.9) translateY(10px); } 
            to { opacity: 1; transform: scale(1) translateY(0); } 
        }
        @keyframes listEntry { 
            from { opacity: 0; transform: translateX(-15px); } 
            to { opacity: 1; transform: translateX(0); } 
        }
        @keyframes fadeIn { 
            from { opacity: 0; } 
            to { opacity: 1; } 
        }
        @keyframes slideUp { 
            from { opacity: 0; transform: translateY(20px); } 
            to { opacity: 1; transform: translateY(0); } 
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .stat-card { background: var(--surface); padding: 20px; border-radius: 20px; box-shadow: var(--shadow); display: flex; justify-content: space-between; align-items: center; position: relative; overflow: hidden; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); animation: popIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards; opacity: 0; }
        .stat-card:active { transform: scale(0.98); }
        
        .stat-info h3 { font-size: 0.8rem; color: var(--text-light); margin-bottom: 5px; text-transform: uppercase; font-weight: 700; letter-spacing: 0.5px; }
        .stat-info p { font-size: 1.6rem; font-weight: 800; color: var(--text-main); }
        .stat-icon { width: 45px; height: 45px; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 1.3rem; box-shadow: 0 4px 6px rgba(0,0,0,0.05); animation: fadeIn 0.6s ease forwards; opacity: 0; animation-delay: 0.2s; }
        
        .c-blue .stat-icon { background: #e1f5fe; color: var(--primary); }
        .c-green .stat-icon { background: #e8f5e9; color: var(--success); }
        .c-orange .stat-icon { background: #fff3e0; color: var(--accent); }
        .c-red .stat-icon { background: #ffebee; color: var(--danger); }

        .table-container { background: var(--surface); border-radius: 20px; box-shadow: var(--shadow); overflow: hidden; margin-top: 15px; border: 1px solid rgba(0,0,0,0.05); animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .table-header { padding: 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--light); }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 15px 20px; text-align: left; border-bottom: 1px solid var(--light); font-size: 0.95rem; color: var(--text-main); }
        th { background: rgba(0,0,0,0.02); font-weight: 700; color: var(--text-light); text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.5px; }
        
        .btn-action { width: 38px; height: 38px; border-radius: 10px; border: none; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); margin-right: 5px; font-size: 1.1rem; }
        .btn-action:active { transform: scale(0.9); }
        .btn-edit { background: rgba(255, 167, 38, 0.15); color: var(--accent); }
        .btn-del { background: rgba(239, 83, 80, 0.15); color: var(--danger); }
        .btn-print { background: rgba(38, 198, 218, 0.15); color: #00897b; }

        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.8); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(5px); opacity: 0; transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        .modal.open { display: flex; opacity: 1; }
        .modal-content { background: var(--surface); width: 90%; max-width: 450px; padding: 0; border-radius: 24px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); transform: scale(0.9) translateY(20px); transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); max-height: 90vh; overflow-y: auto; }
        .modal.open .modal-content { transform: scale(1) translateY(0); animation: popIn 0.5s; }
        
        .modal-header { padding: 20px 25px; border-bottom: 1px solid var(--light); display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.02); }
        .modal-header h3 { font-size: 1.2rem; color: var(--text-main); font-weight: 700; }
        .close-modal { background: none; border: none; font-size: 1.8rem; color: var(--text-light); cursor: pointer; padding: 5px; transition: transform 0.2s; }
        .close-modal:active { transform: scale(0.9); }
        .modal-body { padding: 25px; }
        .modal-footer { padding: 20px 25px; background: rgba(0,0,0,0.02); display: flex; justify-content: flex-end; gap: 12px; }

        input, select { width: 100%; padding: 14px 16px; margin-bottom: 20px; border: 2px solid var(--light); border-radius: 12px; font-size: 1rem; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); background: var(--light); color: var(--text-main); -webkit-appearance: none; }
        input:focus, select:focus { border-color: var(--primary); background: var(--surface); box-shadow: 0 0 0 4px rgba(2, 136, 209, 0.1); transform: translateY(-2px); }
        label { display: block; margin-bottom: 8px; font-size: 0.9rem; font-weight: 600; color: var(--text-main); }

        .chart-box { background: var(--surface); padding: 25px; border-radius: 20px; box-shadow: var(--shadow); height: 320px; display: flex; flex-direction: column; position: relative; animation: slideUp 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        .bar-chart { flex: 1; display: flex; align-items: flex-end; justify-content: space-around; padding-top: 20px; }
        .bar-wrapper { display: flex; flex-direction: column; align-items: center; width: 12%; height: 100%; justify-content: flex-end; animation: slideUp 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards; opacity: 0; }
        .bar { width: 100%; background: linear-gradient(to top, var(--primary), var(--secondary)); border-radius: 8px 8px 0 0; transition: height 1s cubic-bezier(0.4, 0, 0.2, 1); min-height: 6px; position: relative; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .bar-val { position: absolute; top: -30px; width: 300%; left: -100%; text-align: center; font-size: 0.7rem; font-weight: 700; color: var(--text-main); opacity: 1; }
        .bar-lbl { font-size: 0.75rem; color: var(--text-light); margin-top: 10px; font-weight: 600; }

        .fab { 
            position: fixed; 
            bottom: 30px; 
            right: 30px; 
            width: 60px; 
            height: 60px; 
            background: linear-gradient(135deg, var(--primary), var(--secondary)); 
            border-radius: 50%; 
            box-shadow: 0 10px 20px rgba(2, 136, 209, 0.4); 
            display: none; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 2rem; 
            border: none; 
            z-index: 95; 
            cursor: pointer; 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
            animation: pulse 2s infinite;
        }
        .fab:active { transform: scale(0.85); }

        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); background: #323232; color: white; padding: 12px 24px; border-radius: 50px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 3000; font-size: 0.95rem; display: flex; align-items: center; gap: 10px; opacity: 0; width: max-content; max-width: 90%; }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .toast-icon { font-size: 1.2rem; animation: popIn 0.3s; }

        .sale-input-group, .import-input-group { 
            margin-bottom: 20px; 
            padding: 15px; 
            background: rgba(2, 136, 209, 0.05); 
            border-radius: 12px; 
            border: 1px solid rgba(2, 136, 209, 0.1);
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1) forwards;
            opacity: 0;
        }
        .sale-input-group h4, .import-input-group h4 { 
            margin-bottom: 10px; 
            color: var(--primary); 
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .reset-confirm { 
            display: none; 
            background: rgba(239, 83, 80, 0.1); 
            padding: 15px; 
            border-radius: 12px; 
            margin-top: 10px; 
            border: 1px solid var(--danger);
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .reset-confirm p { 
            color: var(--danger); 
            margin-bottom: 10px; 
            font-size: 0.9rem;
        }
        .reset-confirm-btns { 
            display: flex; 
            gap: 10px;
        }
        .reset-confirm-btns button { 
            flex: 1; 
            padding: 10px; 
            border: none; 
            border-radius: 8px; 
            cursor: pointer; 
            font-weight: 600;
            transition: all 0.2s;
        }
        .reset-confirm-btns button:active { transform: scale(0.95); }
        .reset-cancel { background: var(--light); color: var(--text-main); }
        .reset-sure { background: var(--danger); color: white; }

        .confirm-modal .modal-content { max-width: 400px; }
        .confirm-modal .modal-body { text-align: center; padding: 30px; }
        .confirm-icon { font-size: 3rem; margin-bottom: 20px; color: var(--danger); }
        .confirm-buttons { display: flex; gap: 10px; margin-top: 25px; }
        .confirm-buttons button { flex: 1; padding: 12px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .confirm-buttons button:active { transform: scale(0.95); }
        .confirm-cancel { background: var(--light); color: var(--text-main); }
        .confirm-ok { background: var(--danger); color: white; }

        .save-status {
            position: fixed;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--success);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 9999;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .save-status.show {
            opacity: 1;
            animation: slideUp 0.3s;
        }
        .save-status.error {
            background: var(--danger);
        }

        @media (max-width: 768px) {
            .sidebar { position: fixed; transform: translateX(-105%); width: 85%; height: 100%; box-shadow: 5px 0 25px rgba(0,0,0,0.2); }
            .sidebar.active { transform: translateX(0); animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
            
            .toggle-btn { display: block; }
            .fab { display: flex; }
            .hide-on-mobile { display: none !important; }
            
            .stats-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            
            .table-container { background: transparent; box-shadow: none; border: none; }
            table, thead, tbody, th, td, tr { display: block; }
            thead tr { position: absolute; top: -9999px; left: -9999px; }
            tr { background: var(--surface); margin-bottom: 15px; border-radius: 16px; padding: 15px; box-shadow: var(--shadow); animation: listEntry 0.4s ease forwards; opacity: 0; }
            td { border: none; position: relative; padding: 8px 0; padding-left: 45%; text-align: right; border-bottom: 1px solid var(--light); }
            td:last-child { border-bottom: none; padding-bottom: 0; justify-content: flex-end; display: flex; }
            td:before { position: absolute; left: 0; top: 8px; width: 40%; padding-right: 10px; white-space: nowrap; text-align: left; font-weight: 700; color: var(--text-light); content: attr(data-label); font-size: 0.8rem; text-transform: uppercase; }
            
            tr:nth-child(1) { animation-delay: 0.05s; }
            tr:nth-child(2) { animation-delay: 0.1s; }
            tr:nth-child(3) { animation-delay: 0.15s; }
            tr:nth-child(4) { animation-delay: 0.2s; }
            tr:nth-child(5) { animation-delay: 0.25s; }
            
            .modal-content { width: 95%; max-height: 85vh; }
            .chart-box { padding: 15px; height: 280px; }
            
            h2 { font-size: 1.2rem; }
            .btn-action { width: 42px; height: 42px; font-size: 1.2rem; margin-left: 5px; }
            
            .save-status {
                bottom: 80px;
                font-size: 0.7rem;
                padding: 6px 12px;
            }
        }
    </style>
</head>
<body>

<div class="sidebar" id="sidebar">
    <div class="brand">üíß <span>ALKOZAY</span></div>
    <ul class="nav-links">
        <li class="nav-item active" onclick="router('dashboard')">üìä Dashboard</li>
        <li class="nav-item" onclick="router('imports')">üöö Bottle Imports</li>
        <li class="nav-item" onclick="router('sales')">üí∞ Sales Point</li>
        <li class="nav-item" onclick="router('inventory')">üì¶ Inventory</li>
        <li class="nav-item" onclick="router('reports')">üìà Reports</li>
        <li class="nav-item" onclick="router('settings')">‚öôÔ∏è Settings</li>
    </ul>
    <div style="padding: 20px; color: rgba(255,255,255,0.3); font-size: 0.8rem; text-align: center;">
        v4.0 - OFFLINE MODE
    </div>
</div>

<div id="overlay" onclick="toggleSidebar()" style="position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:900; display:none; opacity:0; transition:opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);"></div>

<div class="main-content">
    <header>
        <div style="display:flex; align-items:center; gap:10px;">
            <button class="toggle-btn" onclick="toggleSidebar()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
            </button>
            <div class="header-title">
                <h2 id="page-title">Dashboard</h2>
                <p id="factory-sub">System Ready</p>
            </div>
        </div>
        <div style="display: flex; align-items: center;">
            <button class="theme-switch" onclick="toggleTheme()">üåì</button>
            <button class="btn-primary hide-on-mobile" onclick="openSaleModal()">+ New Sale</button>
        </div>
    </header>

    <div id="dashboard" class="view active">
        <div class="stats-grid">
            <div class="stat-card c-blue" style="animation-delay: 0.1s">
                <div class="stat-info">
                    <h3>Today Rev</h3>
                    <p id="d-today-rev">0</p>
                </div>
                <div class="stat-icon">üí∞</div>
            </div>
            <div class="stat-card c-green" style="animation-delay: 0.2s">
                <div class="stat-info">
                    <h3>Stock Val</h3>
                    <p id="d-stock-val">0</p>
                </div>
                <div class="stat-icon">üìà</div>
            </div>
            <div class="stat-card c-orange" style="animation-delay: 0.3s">
                <div class="stat-info">
                    <h3>Small</h3>
                    <p id="d-small-qty">0</p>
                </div>
                <div class="stat-icon">S</div>
            </div>
            <div class="stat-card c-orange" style="animation-delay: 0.4s">
                <div class="stat-info">
                    <h3>Large</h3>
                    <p id="d-large-qty">0</p>
                </div>
                <div class="stat-icon">L</div>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            <div class="chart-box" style="animation-delay: 0.3s">
                <h3 style="margin-bottom:10px; font-size:1rem; color:var(--text-main);">Sales Analytics</h3>
                <div class="bar-chart" id="sales-chart"></div>
            </div>
            <div class="table-container" style="margin-top:0; animation-delay: 0.4s">
                <div class="table-header"><h3>Recent Activity</h3></div>
                <table style="font-size:0.85rem;">
                    <thead><tr><th>Type</th><th>Desc</th><th>Time</th></tr></thead>
                    <tbody id="dash-activity"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="imports" class="view">
        <div class="table-container" style="animation-delay: 0.2s">
            <div class="table-header">
                <h3>Import Records</h3>
                <button class="btn-primary" onclick="openImportModal()">+ Add</button>
            </div>
            <table>
                <thead><tr><th>Date</th><th>Supplier</th><th>Type</th><th>Qty</th><th>Cost</th><th>Actions</th></tr></thead>
                <tbody id="list-imports"></tbody>
            </table>
        </div>
    </div>

    <div id="sales" class="view">
        <div class="table-container" style="animation-delay: 0.2s">
            <div class="table-header" style="flex-wrap: wrap; gap:10px;">
                <h3>Sales Transactions</h3>
                <input type="text" placeholder="Search..." id="search-sale" onkeyup="renderSales()" style="width:100%; max-width:200px; margin:0; padding:10px;">
            </div>
            <table>
                <thead><tr><th>Date</th><th>Description</th><th>Amount</th><th>Actions</th></tr></thead>
                <tbody id="list-sales"></tbody>
            </table>
        </div>
    </div>

    <div id="inventory" class="view">
        <div class="stats-grid">
            <div class="stat-card c-blue" style="animation-delay: 0.2s">
                <div class="stat-info">
                    <h3>Small Bottles</h3>
                    <p id="inv-s-qty">0</p>
                    <small style="color:var(--text-light)">Packs: <span id="inv-s-packs">0</span></small>
                </div>
            </div>
            <div class="stat-card c-blue" style="animation-delay: 0.3s">
                <div class="stat-info">
                    <h3>Large Bottles</h3>
                    <p id="inv-l-qty">0</p>
                    <small style="color:var(--text-light)">Packs: <span id="inv-l-packs">0</span></small>
                </div>
            </div>
        </div>
    </div>

    <div id="reports" class="view">
        <div class="table-container" style="padding:20px; animation-delay: 0.2s">
            <div style="display:flex; gap:15px; align-items:center; margin-bottom:20px;">
                <h3>Monthly Report</h3>
                <input type="month" id="report-month" onchange="generateReport()" style="width:auto; margin:0; padding: 10px;">
            </div>
            <div class="stats-grid" style="margin-bottom:0;">
                <div class="stat-card c-green" style="animation-delay: 0.3s"><div class="stat-info"><h3>Income</h3><p id="rep-inc">0</p></div></div>
                <div class="stat-card c-red" style="animation-delay: 0.4s"><div class="stat-info"><h3>Expense</h3><p id="rep-exp">0</p></div></div>
                <div class="stat-card c-blue" style="animation-delay: 0.5s"><div class="stat-info"><h3>Net Profit</h3><p id="rep-net">0</p></div></div>
            </div>
        </div>
        
        <div class="table-container" style="margin-top:20px; padding:20px; animation-delay: 0.3s">
            <div class="table-header">
                <h3>üìä All Bottles Data</h3>
            </div>
            <div class="stats-grid" style="margin-bottom:0;">
                <div class="stat-card c-green" style="animation-delay: 0.4s">
                    <div class="stat-info">
                        <h3>Total Imported</h3>
                        <p id="rep-total-imported">0</p>
                        <small style="color:var(--text-light)">Small: <span id="rep-imported-s">0</span> | Large: <span id="rep-imported-l">0</span></small>
                    </div>
                    <div class="stat-icon">üì•</div>
                </div>
                <div class="stat-card c-red" style="animation-delay: 0.5s">
                    <div class="stat-info">
                        <h3>Total Sold</h3>
                        <p id="rep-total-sold">0</p>
                        <small style="color:var(--text-light)">Small: <span id="rep-sold-s">0</span> | Large: <span id="rep-sold-l">0</span></small>
                    </div>
                    <div class="stat-icon">üì§</div>
                </div>
                <div class="stat-card c-blue" style="animation-delay: 0.6s">
                    <div class="stat-info">
                        <h3>Current Stock</h3>
                        <p id="rep-current-stock">0</p>
                        <small style="color:var(--text-light)">Small: <span id="rep-stock-s">0</span> | Large: <span id="rep-stock-l">0</span></small>
                    </div>
                    <div class="stat-icon">üì¶</div>
                </div>
            </div>
        </div>
        
        <div class="table-container" style="margin-top:20px; animation-delay: 0.4s">
            <div class="table-header"><h3>Detailed Ledger</h3></div>
            <table>
                <thead><tr><th>Date</th><th>Type</th><th>Details</th><th>Amount</th></tr></thead>
                <tbody id="rep-list"></tbody>
            </table>
        </div>
    </div>

    <div id="settings" class="view">
        <div class="table-container" style="padding:30px; max-width:800px; margin: 0 auto; animation-delay: 0.2s">
            <h3>Factory Configuration</h3><br>
            <label>Factory Name</label><input type="text" id="set-name">
            <label>Location</label><input type="text" id="set-loc">
            
            <h4 style="margin-top:20px; color:var(--text-main);">Pricing (Per Pack)</h4>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                <div><label>Small Pack</label><input type="number" id="set-p-s"></div>
                <div><label>Large Pack</label><input type="number" id="set-p-l"></div>
            </div>

            <h4 style="margin-top:20px; color:var(--text-main);">Stock Alerts</h4>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                <div><label>Min Small</label><input type="number" id="set-lim-s"></div>
                <div><label>Min Large</label><input type="number" id="set-lim-l"></div>
            </div>

            <div style="margin-top:30px; display:flex; flex-direction: column; gap:15px;">
                <button class="btn-primary" style="justify-content:center; width:100%;" onclick="saveSettings()">Save Changes</button>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn-primary" style="flex:1; background: var(--secondary); justify-content:center;" onclick="exportData()">‚¨á Export JSON</button>
                    <button class="btn-primary" style="flex:1; background: var(--success); justify-content:center;" onclick="importData()">‚¨Ü Import JSON</button>
                </div>
                
                <button class="btn-primary" style="background: var(--danger); justify-content:center;" onclick="showResetConfirm()">‚ö† Reset Data</button>
                
                <div class="reset-confirm" id="resetConfirm">
                    <p>Are you sure you want to reset all data? This cannot be undone!</p>
                    <div class="reset-confirm-btns">
                        <button class="reset-cancel" onclick="hideResetConfirm()">Cancel</button>
                        <button class="reset-sure" onclick="confirmResetData()">Sure, Reset</button>
                    </div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(38, 198, 218, 0.1); border-radius: 12px;">
                    <h4 style="color: var(--secondary); margin-bottom: 10px;">üìä Database Info</h4>
                    <div style="font-size: 0.9rem; color: var(--text-light);">
                        <div>Status: <span id="db-status" style="color: var(--success);">‚úÖ Connected</span></div>
                        <div>Storage: <span id="db-size">Loading...</span></div>
                        <div>Last Save: <span id="last-save">Just now</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<button class="fab" onclick="openSaleModal()">+</button>

<div class="save-status" id="saveStatus">
    <span class="toast-icon" id="saveIcon">üíæ</span>
    <span id="saveText">Saved Successfully!</span>
</div>

<div id="toast" class="toast">
    <span class="toast-icon">‚úÖ</span> <span id="toast-msg">Success</span>
</div>

<!-- CONFIRMATION MODAL -->
<div class="modal confirm-modal" id="modal-confirm">
    <div class="modal-content">
        <div class="modal-body">
            <div class="confirm-icon">‚ö†Ô∏è</div>
            <h3 id="confirm-title">Confirm Action</h3>
            <p id="confirm-message">Are you sure you want to perform this action?</p>
            <div class="confirm-buttons">
                <button class="confirm-cancel" onclick="closeModal('modal-confirm')">Cancel</button>
                <button class="confirm-ok" onclick="confirmAction()">OK</button>
            </div>
        </div>
    </div>
</div>

<!-- IMPORT MODAL -->
<div class="modal" id="modal-import">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="imp-modal-title">Add Import</h3>
            <button class="close-modal" onclick="closeModal('modal-import')">&times;</button>
        </div>
        <div class="modal-body">
            <input type="hidden" id="imp-id">
            <label>Supplier / City</label>
            <input type="text" id="imp-sup">
            
            <label>Import Type</label>
            <select id="imp-config" onchange="uiToggleImportInputs()">
                <option value="both">Both Bottles</option>
                <option value="small">Small Bottles Only</option>
                <option value="large">Large Bottles Only</option>
            </select>

            <div class="import-input-group" id="imp-grp-s">
                <h4>üì¶ Small Bottles Quantity</h4>
                <input type="number" id="imp-q-s" placeholder="Enter quantity" oninput="uiCalcImport()">
            </div>

            <div class="import-input-group" id="imp-grp-l">
                <h4>üì¶ Large Bottles Quantity</h4>
                <input type="number" id="imp-q-l" placeholder="Enter quantity" oninput="uiCalcImport()">
            </div>
            
            <label>Cost Per Bottle</label>
            <input type="number" id="imp-cost" placeholder="Cost per bottle" oninput="uiCalcImport()">
            
            <div style="background: rgba(38, 198, 218, 0.1); color: var(--secondary); padding:15px; border-radius:12px; text-align:center; margin-bottom:15px; border: 1px solid var(--secondary);">
                <span style="font-size:0.9rem;">Total Cost</span><br>
                <strong style="font-size:1.6rem;" id="imp-total">0</strong>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn-primary" style="background:var(--text-light)" onclick="closeModal('modal-import')">Cancel</button>
            <button class="btn-primary" onclick="saveImport()">Save Import</button>
        </div>
    </div>
</div>

<!-- SALE MODAL -->
<div class="modal" id="modal-sale">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="sale-modal-title">New Sale</h3>
            <button class="close-modal" onclick="closeModal('modal-sale')">&times;</button>
        </div>
        <div class="modal-body">
            <input type="hidden" id="sale-id">
            
            <label>Sale Type</label>
            <select id="sale-config" onchange="uiToggleSaleInputs()">
                <option value="both">Both Packs</option>
                <option value="small">Small Packs Only</option>
                <option value="large">Large Packs Only</option>
            </select>

            <div class="sale-input-group" id="grp-s">
                <h4>üì¶ Small Packs Quantity (‚Çπ<span id="p-s-lbl">0</span>/pack)</h4>
                <input type="number" id="sale-q-s" placeholder="Enter number of packs" oninput="uiCalcSale()">
            </div>

            <div class="sale-input-group" id="grp-l">
                <h4>üì¶ Large Packs Quantity (‚Çπ<span id="p-l-lbl">0</span>/pack)</h4>
                <input type="number" id="sale-q-l" placeholder="Enter number of packs" oninput="uiCalcSale()">
            </div>
            
            <div style="background: linear-gradient(135deg, rgba(38, 198, 218, 0.1), rgba(2, 136, 209, 0.1)); color: var(--secondary); padding:15px; border-radius:12px; text-align:center; margin-bottom:15px; border: 1px solid var(--secondary);">
                <span style="font-size:0.9rem;">Total Amount</span><br>
                <strong style="font-size:1.6rem;" id="sale-total">0</strong>
            </div>

            <label>Notes / Customer</label>
            <input type="text" id="sale-note" placeholder="Customer name or notes...">
        </div>
        <div class="modal-footer">
            <button class="btn-primary" style="background:var(--text-light)" onclick="closeModal('modal-sale')">Cancel</button>
            <button class="btn-primary" onclick="saveSale()">Complete Sale</button>
        </div>
    </div>
</div>

<input type="file" id="jsonFileInput" accept=".json" style="display:none;">
